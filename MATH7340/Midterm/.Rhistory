knitr::opts_chunk$set(echo = TRUE)
library(multtest)
X_range <- c(1,2,3)
f.x <- function(x) 2.469862*(x*exp(-x^2))
f_x <- function(x) f.x(x)*(x %in% X_range)
sum(X_range*f_x(X_range))
f.x(1) + f.x(2) + f.x(3)
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
sum(X_range*f_X(X_range))
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
integrate(function(y) y*f_Y(Y), lower=0, upper=Inf)
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
sum(X_range*f_X(X_range))
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
integrate(function(y) y*f_Y(y), lower=0, upper=Inf)
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
sum(X_range*f_X(X_range))
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
integrate(function(y) y*f_Y(y), lower=0, upper=Inf)
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
sum(X_range*f_X(X_range))
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
integrate(function(y) y*f_Y(y), lower=0, upper=Inf)$value
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
# E(X)
EX <- sum(X_range*f_X(X_range))
VarX <- sum((X_range-EX)^2*f_X(X_range))
sdX <- sqrt(VarX)
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
# E(Y)
integrate(function(y) y*f_Y(y), lower=0, upper=Inf)$value
VarX
sdX
X_range
EX
cat("E(2X−3Y)=", 2*EX -3*EY)
cat("E(2X−3Y)="+2*EX -3*EY)
cat("E(2X−3Y)="+str(2*EX -3*EY))
X_range <- c(1,2,3)
f.X <- function(x) 2.469862*(x*exp(-x^2))
f_X <- function(x) f.X(x)*(x %in% X_range)
# E(X)
EX <- sum(X_range*f_X(X_range))
EX
# sd(X)
VarX <- sum((X_range-EX)^2*f_X(X_range))
sdX <- sqrt(VarX)
sdX
f_Y <- function(y) 2*y*exp(-y^2)*(y > 0)
# E(Y)
EY <- integrate(function(y) y*f_Y(y), lower=0, upper=Inf)$value
EY
# sd(Y)
VarY <- integrate(function(y) (y-EY)^2*f_Y(y), lower=0, upper=Inf)$value
sdY <- sqrt(VarY)
sdY
cat("E(2X−3Y)="+str(2*EX -3*EY))
cat("E(2X-3Y)=",
2*EX-3*EY, "\n")
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+Y)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
mean(z)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
format(mean(z), nsmall = 2)
x <- rnorm(100000, mean=0, sd=1)
y <- rchisq(100000, df=4)
z <- x^2/(x^2+y)
res <- mean(z)
format(round(res, 2), nsmall = 2)
cat("P(X>940)", 1-pbinom(940, size=1000, prob=0.92), "\n")
cat("P(X>940)=", 1-pbinom(940, size=1000, prob=0.92), "\n")
golub[,2]
library(multtest)
data(golub)
golub.gnames
golub.gnames[,2]
hist(golub[2715,])
hist(golub[2715,], main = "Histogram of GRO3 expression values", ylim=c(0,30), xlab="expression value")
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=golub.cl)
data(iris)
iris$Species
golub.cl
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=fol.fac)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=c(1,2))
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
gol.fac <- factor(golub.cl, levels=1:2, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
legend(1,0.5 ,unique(gol.fac),col=1:length(gol.fac),pch=1)
length(gol.fac)
unique(gol.fac)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac)
legend(1,0.8 ,unique(gol.fac),col=1:length(gol.fac),pch=1)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
exp2715th = golub[2715,]
exp2302th = golub[2302,]
plot(exp2715th ~ exp2302th, col=gol.fac, xlab = "MYC gene expression values", ylab = "GRO3 gene expression values")
legend(1,0.8 ,unique(gol.fac),col=1:length(gol.fac),pch=1)
t.test(golub[2715,]-golub[2302,], alternative = "less")
t.test(golub[2715,], golub[2302,], alternative = "less", paired=T )
shapiro.test(golub[2715,]-golub[2302,])
golub[2715,]-golub[2302,]
shapiro.test(golub[2715,]-golub[2302,])
hist(golub[2715,]-golub[2302,])
golub[2715,]
golub[2302,]
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less")
data(golub)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
p.values <- apply(golub, 1, function(x)
wilcox.test(x~gol.fac, paired = F, alternative = "greater")$p.value )
p.fdr <-p.adjust(p=p.values, method="fdr")
sum(p.fdr < 0.05)
data(golub)
grep(“HPCA Hippocalcin”, golub.gnames[,2])
data(golub)
grep("HPCA Hippocalcin", golub.gnames[,2])
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
sum(golub[118, gol.fac=="ALL"]<0)
gol.fac <- factor(golub.cl, levels=0:1, labels=c("ALL", "AML"))
sum(golub[118, gol.fac=="ALL"]<0)/length(golub[118, gol.fac=="ALL"])
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p=0.5, alternative = "greater")
sum(res)
length(res)
16/27
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p<0.5, alternative = "greater")
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p=0.5, alternative = "greater")
length(res)
16/27
c(mean(obs), sqrt(sum((obs-mean(obs))^2)/length(obs)))
obs <-as.numeric(t(read.table(file = "normalData.txt", header=T)))
nloglik <- function(theta) {
-sum ( log(dnorm(obs, mean=theta, sd=theta)))
}
optim(2, nloglik)
obs <-as.numeric(t(read.table(file = "normalData.txt", header=T)))
nloglik <- function(theta) {
-sum ( log(dnorm(obs, mean=theta, sd=theta)))
}
optim(par=c(2), nloglik)
obs <-as.numeric(t(read.table(file = "normalData.txt", header=T)))
nloglik <- function(theta) {
-sum ( log(dnorm(obs, mean=theta, sd=theta)))
}
optim(par=c(2), nloglik)$par
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p=0.5, alternative = "greater")
binom.test(sum(res), length(res), p=0.5, alternative = "less")
binom.test(sum(res), length(res), p=0.6, alternative = "less")
binom.test(sum(res), length(res), p=0.5, alternative = "less")
binom.test(sum(res), length(res), p=0.49, alternative = "greater")
binom.test(sum(res), length(res), p=0.3, alternative = "greater")
binom.test(sum(res), length(res), p=0.5, alternative = "greater")
binom.test(sum(res), length(res), p=0.6, alternative = "greater")
binom.test(sum(res), length(res), p=0.5, alternative = "greater")
binom.test(sum(res), length(res), p=0.5, alternative = "less")
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p=0.5, alternative = "less")
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.level = 0.95)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
shapiro.test(golub[2715,]-golub[2302,])
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
median(golub[2715,]-golub[2302,])
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
qt(0.975, df=10)
qt(0.025, df=10)
golub[2715,]-golub[2302,]
res <- golub[2715,]-golub[2302,]
res <- res[res != 0]
res
wilcox.test (res, paired=T, alternative="less")
wilcox.test (res, alternative="less")
median(golub[2715,]-golub[2302,])
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="less", conf.int = TRUE)
wilcox.test (x= golub[2715,], y= golub[2302,], paired=T, alternative="greater", conf.int = TRUE)
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- diff[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
dif <- golub[2715,] - golub[2302,]
dif
dif[sample(1:38, replace=TRUE)]
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
mean(dif[sample(1:38, replace=TRUE)])
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.diff,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-10000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-median(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-median(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-median(data.star)
}
quantile(boot.dif,c(0.95))
boot.dif
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-median(data.star)
}
quantile(boot.dif,c(0.05))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-median(data.star)
}
quantile(boot.dif,c(0.05, 0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.05, 0.95))
dif <- golub[2715,] - golub[2302,]
n<-length(dif)
nboot<-1000
boot.dif <- rep(NA, nboot)
for (i in 1:nboot) {
data.star <- dif[sample(1:n,replace=TRUE)]
boot.dif[i]<-mean(data.star)
}
quantile(boot.dif,c(0.95))
res <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(res), length(res), p=0.5, alternative = "less")
resALL <- golub[118, gol.fac=="ALL"] < 0
binom.test(sum(resALL), length(resALL), p=0.5, alternative = "less")
resALL <- golub[118, gol.fac=="ALL"] < 0
lengthALL <- length(resALL)
numALL <- sum(resALL)
binom.test(numALL, lengthALL, p=0.5, alternative = "less")
resAML <- golub[118, gol.fac=="AML"] < 0
lengthAML <- length(resAML)
numAML <- sum(resAML)
#binom.test(numALL, lengthALL, p=0.5, alternative = "less")
resAML
lengthAML
numAML
resAML <- golub[118, gol.fac=="AML"] < 0
lengthAML <- length(resAML)
numAML <- sum(resAML)
#binom.test(numALL, lengthALL, p=0.5, alternative = "less")
prop.test(x=c(numALL, numAML), n=c(lengthALL, lengthAML), alternative="two.sided")
numALL/lengthALL
numAML/lengthAML
knitr::opts_chunk$set(echo = TRUE)
library(multtest)
data(golub)
p.values <- apply(golub, 1, function(x) t.test(x, mu=0.6, alternative = "greater")$p.value)
p.fdr <- p.adjust(p=p.values, method = "fdr")
sum(p.values<0.1)
data(golub)
p.values <- apply(golub, 1, function(x) t.test(x, mu=0.6, alternative = "greater")$p.value)
p.fdr <- p.adjust(p=p.values, method = "fdr")
sum(p.values<0.05)
t.test(golub[2715,]-golub[2302,], alternative = "less")
t.test(golub[2715,], golub[2302,], alternative = "less", paired=T )
t.test(golub[2715,], golub[2302,], alternative = "less")
data(golub)
p.values <- apply(golub, 1, function(x) t.test(x, mu=0.6, alternative = "greater")$p.value)
p.fdr <- p.adjust(p=p.values, method = "fdr")
sum(p.fdr < 0.1)
